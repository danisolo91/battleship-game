(this.webpackJsonpbattleship=this.webpackJsonpbattleship||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(8),s=n.n(c),i=(n(13),n(2)),o=n(3),l=n(0),u=Object(r.createContext)(),j=function(e){var t=Object(r.useState)({gameOver:!1,turn:0,players:[],boards:[]}),n=Object(o.a)(t,2),a=n[0],c=n[1];return Object(l.jsx)(u.Provider,{value:[a,c],children:e.children})},b=n(5),h=function(){var e=[],t=[],n=function(n,r){n.forEach((function(t){r.addPosition(t),e[t]="s"})),t.push(r)},r=function(e,t,n){var r=[];return"X"===t?r=a(e,n):"Y"===t&&(r=c(e,n)),r.length>0&&s(r)&&(r=[]),r},a=function(e,t){var n=Math.floor(e/10),r=[];if(Math.floor((e+t.length-1)/10)===n)for(var a=e;a<=e+t.length-1;a++)r.push(a);return r},c=function(e,t){var n=e+10*t.length-10,r=[];if(n<100)for(var a=e;a<=n;a+=10)r.push(a);return r},s=function(e){var n,r=!1,a=Object(b.a)(e);try{var c=function(){var e=n.value;if(t.some((function(t){return t.hasPosition(e)})))return r=!0,"break"};for(a.s();!(n=a.n()).done;){if("break"===c())break}}catch(s){a.e(s)}finally{a.f()}return r};return{init:function(){for(var t=0;t<100;t++)e.push(!1)},getBoard:function(){return e},getShips:function(){return t},getPlace:r,addShip:n,placeShipsRandomly:function(e){e.forEach((function(e){for(var t=[];0===t.length;){var a=Math.floor(2*Math.random())?"X":"Y",c=Math.floor(100*Math.random());t=r(c,a,e)}n(t,e)}))},receiveAttack:function(n){!1===e[n]?e[n]=!0:"s"===e[n]&&(e[n]="sh");var r=t.find((function(e){return e.hasPosition(n)}));r&&r.hit(n)},hasLost:function(){return 5===t.filter((function(e){return e.isSunk()})).length}}},d=function(){var e=Object(r.useContext)(u),t=Object(o.a)(e,2),n=t[0],a=t[1],c=function(e){var t=n.players[0],r=t.shoot(e);if(null!=r){var c=n.boards[1];c.receiveAttack(r);var s=1,o=!1;c.hasLost()&&(s=0,o=!0),a((function(e){return Object(i.a)(Object(i.a)({},e),{},{gameOver:o,turn:s,players:[t,e.players[1]],boards:[e.boards[0],c]})}))}};return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:n.players[1].nickname}),0===n.turn&&!1===n.gameOver?Object(l.jsx)("div",{className:"board has-turn active",children:n.boards[1].getBoard().map((function(e,t){var n;return!1===e?n=Object(l.jsx)("div",{onClick:function(){return c(t)},className:"cell normal"},t):!0===e?n=Object(l.jsx)("div",{className:"cell water"},t):"s"===e?n=Object(l.jsx)("div",{onClick:function(){return c(t)},className:"cell normal"},t):"sh"===e&&(n=Object(l.jsx)("div",{className:"cell hit"},t)),n}))}):Object(l.jsx)("div",{className:"board",children:n.boards[1].getBoard().map((function(e,t){var n;return!1===e?n=Object(l.jsx)("div",{className:"cell"},t):!0===e?n=Object(l.jsx)("div",{className:"cell water"},t):"s"===e?n=Object(l.jsx)("div",{className:"cell"},t):"sh"===e&&(n=Object(l.jsx)("div",{className:"cell hit"},t)),n}))})]})},f=function(){var e=Object(r.useContext)(u)[0];return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:e.players[0].nickname}),Object(l.jsx)("div",{className:"board",children:e.boards[0].getBoard().map((function(e,t){var n;return!1===e?n=Object(l.jsx)("div",{className:"cell"},t):!0===e?n=Object(l.jsx)("div",{className:"cell water"},t):"s"===e?n=Object(l.jsx)("div",{className:"cell ship"},t):"sh"===e&&(n=Object(l.jsx)("div",{className:"cell hit"},t)),n}))})]})},O=function(e,t){var n=[];return{name:e,length:t,getPositions:function(){return n},addPosition:function(e){n.push({cell:e,isHit:!1})},hasPosition:function(e){return n.some((function(t){return t.cell===e}))},hit:function(e){n.forEach((function(t){return t.cell===e&&(t.isHit=!0),t}))},isSunk:function(){var e,t=!0,r=Object(b.a)(n);try{for(r.s();!(e=r.n()).done;){if(!1===e.value.isHit){t=!1;break}}}catch(a){r.e(a)}finally{r.f()}return t}}},v=function(e){var t=[],n=function(){for(var e=Math.floor(100*Math.random());!r(e);)e=Math.floor(100*Math.random());return e},r=function(e){return!t.includes(e)&&e>=0&&e<100};return{nickname:e,clearShotsHistory:function(){return t=[]},shoot:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=e;return null===a&&(a=n()),r(a)?t.push(a):a=null,a}}},m=function(){var e=Object(r.useContext)(u),t=Object(o.a)(e,2),n=t[0],a=t[1],c=n.boards[0],s=[O("carrier",5),O("battleship",4),O("Cruiser",3),O("Submarine",3),O("Destroyer",2)];return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:n.players[0].nickname}),Object(l.jsx)("div",{className:"board",children:n.boards[0].getBoard().map((function(e,t){var n;return!1===e?n=Object(l.jsx)("div",{className:"cell"},t):!0===e?n=Object(l.jsx)("div",{className:"cell water"},t):"s"===e?n=Object(l.jsx)("div",{className:"cell ship"},t):"sh"===e&&(n=Object(l.jsx)("div",{className:"cell hit"},t)),n}))}),0===n.boards[0].getShips().length?Object(l.jsx)("button",{onClick:function(){c.placeShipsRandomly(s),a((function(e){return Object(i.a)(Object(i.a)({},e),{},{boards:[c]})}))},children:"Place ships"}):Object(l.jsx)("button",{onClick:function(){var e=v("Enemy"),t=h();t.init(),t.placeShipsRandomly(s),a((function(n){return Object(i.a)(Object(i.a)({},n),{},{players:[n.players[0],e],boards:[n.boards[0],t]})}))},children:"Start Game"})]})},x=function(){var e=Object(r.useContext)(u),t=Object(o.a)(e,2),n=t[0],a=t[1];Object(r.useEffect)((function(){if(0===n.boards.length){var e=h();e.init(),a((function(t){return Object(i.a)(Object(i.a)({},t),{},{boards:[e]})}))}if(1===n.turn&&!1===n.gameOver){var t=n.players[1],r=t.shoot();if(null!=r){var c=n.boards[0];c.receiveAttack(r);var s=0,o=!1;c.hasLost()&&(s=1,o=!0),setTimeout((function(){a((function(e){return Object(i.a)(Object(i.a)({},e),{},{gameOver:o,turn:s,players:[e.players[0],t],boards:[c,e.boards[1]]})}))}),1e3)}}}));return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"boards",children:1===n.boards.length?Object(l.jsx)(m,{}):2===n.boards.length&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(f,{}),Object(l.jsx)(d,{})]})}),!0===n.gameOver&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h3",{children:"Game Over"}),Object(l.jsx)("p",{children:0===n.turn?"Congratulations, You have won!":"Computer wins"}),Object(l.jsx)("button",{onClick:function(){var e=n.players[0];e.clearShotsHistory(),a({gameOver:!1,turn:0,players:[e],boards:[]})},children:"Play again"})]})]})},p=n(4),g=function(){var e=Object(r.useContext)(u)[1],t=Object(r.useState)(v("")),n=Object(o.a)(t,2),a=n[0],c=n[1];return Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e((function(e){return Object(i.a)(Object(i.a)({},e),{},{players:[a]})}))},children:[Object(l.jsx)("input",{type:"text",name:"nickname",placeholder:"Enter your nickname...",value:a.nickname,maxLength:"15",minLength:"2",required:!0,onChange:function(e){c((function(t){return Object(i.a)(Object(i.a)({},t),{},Object(p.a)({},e.target.name,e.target.value))}))}}),Object(l.jsx)("button",{type:"submit",children:"Next"})]})})},y=function(){var e=Object(r.useContext)(u)[0];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h1",{children:"Battleship"}),Object(l.jsx)("div",{className:"container",children:0===e.players.length?Object(l.jsx)(g,{}):Object(l.jsx)(x,{})})]})};s.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(j,{children:Object(l.jsx)(y,{})})}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.aa620944.chunk.js.map